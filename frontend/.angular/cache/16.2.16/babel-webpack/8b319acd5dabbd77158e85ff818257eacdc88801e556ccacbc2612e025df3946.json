{"ast":null,"code":"import { io } from 'socket.io-client';\nimport { Observable } from 'rxjs';\nimport { environment } from '../../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./auth.service\";\nexport class SocketService {\n  authService;\n  socket = null;\n  constructor(authService) {\n    this.authService = authService;\n  }\n  connect() {\n    const token = this.authService.getToken();\n    const userStr = localStorage.getItem('user');\n    const user = userStr ? JSON.parse(userStr) : null;\n    if (!token || !user) {\n      console.error('Not authenticated');\n      return;\n    }\n    this.socket = io(environment.apiUrl, {\n      auth: {\n        token,\n        userId: user.id\n      }\n    });\n  }\n  disconnect() {\n    if (this.socket) {\n      this.socket.disconnect();\n      this.socket = null;\n    }\n  }\n  startInterview(interviewId) {\n    if (this.socket) {\n      this.socket.emit('start-interview', {\n        interviewId\n      });\n    }\n  }\n  requestQuestion(interviewId) {\n    if (this.socket) {\n      this.socket.emit('request-question', {\n        interviewId\n      });\n    }\n  }\n  submitAnswer(interviewId, questionId, answerText) {\n    if (this.socket) {\n      this.socket.emit('submit-answer', {\n        interviewId,\n        questionId,\n        answerText\n      });\n    }\n  }\n  onInterviewStarted() {\n    return new Observable(observer => {\n      if (this.socket) {\n        this.socket.on('interview-started', data => observer.next(data));\n      }\n    });\n  }\n  onQuestionReceived() {\n    return new Observable(observer => {\n      if (this.socket) {\n        this.socket.on('question-received', data => observer.next(data));\n      }\n    });\n  }\n  onAnswerEvaluated() {\n    return new Observable(observer => {\n      if (this.socket) {\n        this.socket.on('answer-evaluated', data => observer.next(data));\n      }\n    });\n  }\n  onFollowUpQuestion() {\n    return new Observable(observer => {\n      if (this.socket) {\n        this.socket.on('follow-up-question', data => observer.next(data));\n      }\n    });\n  }\n  onError() {\n    return new Observable(observer => {\n      if (this.socket) {\n        this.socket.on('error', data => observer.next(data));\n      }\n    });\n  }\n  static ɵfac = function SocketService_Factory(t) {\n    return new (t || SocketService)(i0.ɵɵinject(i1.AuthService));\n  };\n  static ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: SocketService,\n    factory: SocketService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["io","Observable","environment","SocketService","authService","socket","constructor","connect","token","getToken","userStr","localStorage","getItem","user","JSON","parse","console","error","apiUrl","auth","userId","id","disconnect","startInterview","interviewId","emit","requestQuestion","submitAnswer","questionId","answerText","onInterviewStarted","observer","on","data","next","onQuestionReceived","onAnswerEvaluated","onFollowUpQuestion","onError","i0","ɵɵinject","i1","AuthService","factory","ɵfac","providedIn"],"sources":["C:\\Users\\Client\\OneDrive\\Desktop\\github_project\\frontend\\src\\app\\core\\services\\socket.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { io, Socket } from 'socket.io-client';\r\nimport { Observable } from 'rxjs';\r\nimport { environment } from '../../../environments/environment';\r\nimport { AuthService } from './auth.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SocketService {\r\n  private socket: Socket | null = null;\r\n\r\n  constructor(private authService: AuthService) {}\r\n\r\n  connect(): void {\r\n    const token = this.authService.getToken();\r\n    const userStr = localStorage.getItem('user');\r\n    const user = userStr ? JSON.parse(userStr) : null;\r\n\r\n    if (!token || !user) {\r\n      console.error('Not authenticated');\r\n      return;\r\n    }\r\n\r\n    this.socket = io(environment.apiUrl, {\r\n      auth: {\r\n        token,\r\n        userId: user.id\r\n      }\r\n    });\r\n  }\r\n\r\n  disconnect(): void {\r\n    if (this.socket) {\r\n      this.socket.disconnect();\r\n      this.socket = null;\r\n    }\r\n  }\r\n\r\n  startInterview(interviewId: string): void {\r\n    if (this.socket) {\r\n      this.socket.emit('start-interview', { interviewId });\r\n    }\r\n  }\r\n\r\n  requestQuestion(interviewId: string): void {\r\n    if (this.socket) {\r\n      this.socket.emit('request-question', { interviewId });\r\n    }\r\n  }\r\n\r\n  submitAnswer(interviewId: string, questionId: string, answerText: string): void {\r\n    if (this.socket) {\r\n      this.socket.emit('submit-answer', { interviewId, questionId, answerText });\r\n    }\r\n  }\r\n\r\n  onInterviewStarted(): Observable<any> {\r\n    return new Observable(observer => {\r\n      if (this.socket) {\r\n        this.socket.on('interview-started', (data) => observer.next(data));\r\n      }\r\n    });\r\n  }\r\n\r\n  onQuestionReceived(): Observable<any> {\r\n    return new Observable(observer => {\r\n      if (this.socket) {\r\n        this.socket.on('question-received', (data) => observer.next(data));\r\n      }\r\n    });\r\n  }\r\n\r\n  onAnswerEvaluated(): Observable<any> {\r\n    return new Observable(observer => {\r\n      if (this.socket) {\r\n        this.socket.on('answer-evaluated', (data) => observer.next(data));\r\n      }\r\n    });\r\n  }\r\n\r\n  onFollowUpQuestion(): Observable<any> {\r\n    return new Observable(observer => {\r\n      if (this.socket) {\r\n        this.socket.on('follow-up-question', (data) => observer.next(data));\r\n      }\r\n    });\r\n  }\r\n\r\n  onError(): Observable<any> {\r\n    return new Observable(observer => {\r\n      if (this.socket) {\r\n        this.socket.on('error', (data) => observer.next(data));\r\n      }\r\n    });\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}