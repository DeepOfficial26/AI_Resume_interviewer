{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { environment } from '../../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class AuthService {\n  http;\n  apiUrl = `${environment.apiUrl}/api/auth`;\n  currentUserSubject = new BehaviorSubject(null);\n  currentUser$ = this.currentUserSubject.asObservable();\n  constructor(http) {\n    this.http = http;\n    const token = localStorage.getItem('token');\n    const userStr = localStorage.getItem('user');\n    if (token && userStr) {\n      this.currentUserSubject.next(JSON.parse(userStr));\n    }\n  }\n  register(email, password, name) {\n    return this.http.post(`${this.apiUrl}/register`, {\n      email,\n      password,\n      name\n    }).pipe(tap(response => this.setAuth(response)));\n  }\n  login(email, password) {\n    return this.http.post(`${this.apiUrl}/login`, {\n      email,\n      password\n    }).pipe(tap(response => this.setAuth(response)));\n  }\n  logout() {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    this.currentUserSubject.next(null);\n  }\n  getToken() {\n    return localStorage.getItem('token');\n  }\n  isAuthenticated() {\n    return !!this.getToken();\n  }\n  setAuth(response) {\n    localStorage.setItem('token', response.token);\n    localStorage.setItem('user', JSON.stringify(response.user));\n    this.currentUserSubject.next(response.user);\n  }\n  static ɵfac = function AuthService_Factory(t) {\n    return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient));\n  };\n  static ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: AuthService,\n    factory: AuthService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["BehaviorSubject","tap","environment","AuthService","http","apiUrl","currentUserSubject","currentUser$","asObservable","constructor","token","localStorage","getItem","userStr","next","JSON","parse","register","email","password","name","post","pipe","response","setAuth","login","logout","removeItem","getToken","isAuthenticated","setItem","stringify","user","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["C:\\Users\\Client\\OneDrive\\Desktop\\github_project\\frontend\\src\\app\\core\\services\\auth.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Observable, BehaviorSubject } from 'rxjs';\r\nimport { tap } from 'rxjs/operators';\r\nimport { environment } from '../../../environments/environment';\r\n\r\nexport interface User {\r\n  id: string;\r\n  email: string;\r\n  name: string;\r\n}\r\n\r\nexport interface AuthResponse {\r\n  token: string;\r\n  user: User;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AuthService {\r\n  private apiUrl = `${environment.apiUrl}/api/auth`;\r\n  private currentUserSubject = new BehaviorSubject<User | null>(null);\r\n  public currentUser$ = this.currentUserSubject.asObservable();\r\n\r\n  constructor(private http: HttpClient) {\r\n    const token = localStorage.getItem('token');\r\n    const userStr = localStorage.getItem('user');\r\n    if (token && userStr) {\r\n      this.currentUserSubject.next(JSON.parse(userStr));\r\n    }\r\n  }\r\n\r\n  register(email: string, password: string, name: string): Observable<AuthResponse> {\r\n    return this.http.post<AuthResponse>(`${this.apiUrl}/register`, { email, password, name })\r\n      .pipe(tap(response => this.setAuth(response)));\r\n  }\r\n\r\n  login(email: string, password: string): Observable<AuthResponse> {\r\n    return this.http.post<AuthResponse>(`${this.apiUrl}/login`, { email, password })\r\n      .pipe(tap(response => this.setAuth(response)));\r\n  }\r\n\r\n  logout(): void {\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('user');\r\n    this.currentUserSubject.next(null);\r\n  }\r\n\r\n  getToken(): string | null {\r\n    return localStorage.getItem('token');\r\n  }\r\n\r\n  isAuthenticated(): boolean {\r\n    return !!this.getToken();\r\n  }\r\n\r\n  private setAuth(response: AuthResponse): void {\r\n    localStorage.setItem('token', response.token);\r\n    localStorage.setItem('user', JSON.stringify(response.user));\r\n    this.currentUserSubject.next(response.user);\r\n  }\r\n}\r\n"],"mappings":"AAEA,SAAqBA,eAAe,QAAQ,MAAM;AAClD,SAASC,GAAG,QAAQ,gBAAgB;AACpC,SAASC,WAAW,QAAQ,mCAAmC;;;AAgB/D,OAAM,MAAOC,WAAW;EAKFC,IAAA;EAJZC,MAAM,GAAG,GAAGH,WAAW,CAACG,MAAM,WAAW;EACzCC,kBAAkB,GAAG,IAAIN,eAAe,CAAc,IAAI,CAAC;EAC5DO,YAAY,GAAG,IAAI,CAACD,kBAAkB,CAACE,YAAY,EAAE;EAE5DC,YAAoBL,IAAgB;IAAhB,KAAAA,IAAI,GAAJA,IAAI;IACtB,MAAMM,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,MAAMC,OAAO,GAAGF,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;IAC5C,IAAIF,KAAK,IAAIG,OAAO,EAAE;MACpB,IAAI,CAACP,kBAAkB,CAACQ,IAAI,CAACC,IAAI,CAACC,KAAK,CAACH,OAAO,CAAC,CAAC;;EAErD;EAEAI,QAAQA,CAACC,KAAa,EAAEC,QAAgB,EAAEC,IAAY;IACpD,OAAO,IAAI,CAAChB,IAAI,CAACiB,IAAI,CAAe,GAAG,IAAI,CAAChB,MAAM,WAAW,EAAE;MAAEa,KAAK;MAAEC,QAAQ;MAAEC;IAAI,CAAE,CAAC,CACtFE,IAAI,CAACrB,GAAG,CAACsB,QAAQ,IAAI,IAAI,CAACC,OAAO,CAACD,QAAQ,CAAC,CAAC,CAAC;EAClD;EAEAE,KAAKA,CAACP,KAAa,EAAEC,QAAgB;IACnC,OAAO,IAAI,CAACf,IAAI,CAACiB,IAAI,CAAe,GAAG,IAAI,CAAChB,MAAM,QAAQ,EAAE;MAAEa,KAAK;MAAEC;IAAQ,CAAE,CAAC,CAC7EG,IAAI,CAACrB,GAAG,CAACsB,QAAQ,IAAI,IAAI,CAACC,OAAO,CAACD,QAAQ,CAAC,CAAC,CAAC;EAClD;EAEAG,MAAMA,CAAA;IACJf,YAAY,CAACgB,UAAU,CAAC,OAAO,CAAC;IAChChB,YAAY,CAACgB,UAAU,CAAC,MAAM,CAAC;IAC/B,IAAI,CAACrB,kBAAkB,CAACQ,IAAI,CAAC,IAAI,CAAC;EACpC;EAEAc,QAAQA,CAAA;IACN,OAAOjB,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EACtC;EAEAiB,eAAeA,CAAA;IACb,OAAO,CAAC,CAAC,IAAI,CAACD,QAAQ,EAAE;EAC1B;EAEQJ,OAAOA,CAACD,QAAsB;IACpCZ,YAAY,CAACmB,OAAO,CAAC,OAAO,EAAEP,QAAQ,CAACb,KAAK,CAAC;IAC7CC,YAAY,CAACmB,OAAO,CAAC,MAAM,EAAEf,IAAI,CAACgB,SAAS,CAACR,QAAQ,CAACS,IAAI,CAAC,CAAC;IAC3D,IAAI,CAAC1B,kBAAkB,CAACQ,IAAI,CAACS,QAAQ,CAACS,IAAI,CAAC;EAC7C;;qBAzCW7B,WAAW,EAAA8B,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA;EAAA;;WAAXjC,WAAW;IAAAkC,OAAA,EAAXlC,WAAW,CAAAmC,IAAA;IAAAC,UAAA,EAFV;EAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}